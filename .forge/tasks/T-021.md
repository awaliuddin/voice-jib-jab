# T-021: Fix: Audit Trail Foreign Key Failure — on first WebSocket co...

**Status:** Completed
**Assigned to:** claude
**Type:** implement
**Phase:** fix
**Parent:** —
**Created:** 2026-02-13 03:41 UTC
**Updated:** 2026-02-13 03:57 UTC

## Description

UAT Finding F-005: Audit Trail Foreign Key Failure — on first WebSocket connection, SQLite throws FOREIGN KEY constraint failed (SQLITE_CONSTRAINT_FOREIGNKEY). Audit event references a session that doesn't exist yet. Race condition: audit event emitted before session row exists. Hard failure dropping audit events.

Severity: critical
Priority: P0
Related tasks: T-006

Fix this issue.

## Dependencies

None

## Locked Files

None

## Acceptance Criteria

None specified
